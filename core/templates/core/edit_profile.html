{% extends 'core/base.html' %}
{% load static %}

{% block title %}Editar Perfil - Monte{% endblock %}

{% block body_class %}edit-profile-body{% endblock %}

{% block content %}
    <div class="edit-profile-container">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-6">
                    <div class="edit-profile-form-wrapper">
                        <div class="edit-profile-header">
                            <h1 class="edit-profile-title">
                                <i class="fas fa-user-edit"></i>
                                Editar Perfil
                            </h1>
                            <p class="edit-profile-subtitle">
                                Atualize suas informações pessoais
                            </p>
                        </div>

                        <form method="post" class="edit-profile-form">
                            {% csrf_token %}
                            
                            <div class="form-group">
                                <label for="{{ form.first_name.id_for_label }}" class="form-label">
                                    <i class="fas fa-user"></i> Nome
                                </label>
                                <input 
                                    type="text" 
                                    name="first_name" 
                                    class="form-control" 
                                    value="{{ form.first_name.value|default:'' }}"
                                    required
                                >
                                {% if form.first_name.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.first_name.errors %}
                                            {{ error }}
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label for="{{ form.last_name.id_for_label }}" class="form-label">
                                    <i class="fas fa-user"></i> Sobrenome
                                </label>
                                <input 
                                    type="text" 
                                    name="last_name" 
                                    class="form-control" 
                                    value="{{ form.last_name.value|default:'' }}"
                                    required
                                >
                                {% if form.last_name.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.last_name.errors %}
                                            {{ error }}
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label for="{{ form.email.id_for_label }}" class="form-label">
                                    <i class="fas fa-envelope"></i> Email
                                </label>
                                <input 
                                    type="email" 
                                    name="email" 
                                    class="form-control" 
                                    value="{{ form.email.value|default:'' }}"
                                    required
                                >
                                <small class="form-text text-muted">
                                    Deve ser um email da PUC-Rio (@puc-rio.br)
                                </small>
                                {% if form.email.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.email.errors %}
                                            {{ error }}
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label for="{{ form.curso.id_for_label }}" class="form-label">
                                    <i class="fas fa-graduation-cap"></i> Curso
                                </label>
                                {{ form.curso }}
                                {% if form.curso.errors %}
                                    <div class="invalid-feedback d-block">
                                        {% for error in form.curso.errors %}
                                            {{ error }}
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-actions">
                                <a href="{% url 'profile' %}" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancelar
                                </a>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Salvar Alterações
                                </button>
                            </div>
                        </form>
                        
                        <!-- Current Stats -->
                        <div class="current-stats">
                            <h5>Seu Progresso Atual</h5>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-mountain"></i>
                                    </div>
                                    <div class="stat-info">
                                        <strong>{{ user.userprofile.current_mountain }}</strong>
                                        <small>Montanha Atual</small>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <div class="stat-info">
                                        <strong>{{ user.userprofile.altitude_points }}</strong>
                                        <small>Pontos de Altitude</small>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-file"></i>
                                    </div>
                                    <div class="stat-info">
                                        <strong>{{ user.material_set.count }}</strong>
                                        <small>Materiais Enviados</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_css %}
<style>
.edit-profile-body {
    background-color: #f8f9fa;
    min-height: 100vh;
    padding: 2rem 0;
}

.edit-profile-form-wrapper {
    background: white;
    border-radius: 15px;
    padding: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.edit-profile-header {
    text-align: center;
    margin-bottom: 2rem;
}

.edit-profile-title {
    color: var(--navy-blue);
    font-size: 2.5rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.edit-profile-subtitle {
    color: #666;
    font-size: 1.1rem;
    margin-bottom: 0;
}

.edit-profile-form .form-group {
    margin-bottom: 1.5rem;
}

.edit-profile-form .form-label {
    font-weight: 500;
    color: var(--navy-blue);
    margin-bottom: 0.5rem;
    display: block;
}

.edit-profile-form .form-label i {
    color: var(--gold);
    margin-right: 0.5rem;
    width: 16px;
}

.edit-profile-form .form-control {
    border: 2px solid #e9ecef;
    border-radius: 8px;
    padding: 0.75rem 1rem;
    font-size: 1rem;
    transition: border-color 0.2s, box-shadow 0.2s;
}

.edit-profile-form .form-control:focus {
    border-color: var(--gold);
    box-shadow: 0 0 0 0.2rem rgba(206, 185, 116, 0.25);
}

.form-text {
    margin-top: 0.25rem;
}

.form-actions {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid #e9ecef;
}

.form-actions .btn {
    padding: 0.75rem 2rem;
    font-weight: 500;
    border-radius: 8px;
}

.btn-primary {
    background-color: var(--navy-blue);
    border-color: var(--navy-blue);
}

.btn-primary:hover {
    background-color: var(--gold);
    border-color: var(--gold);
    color: var(--navy-blue);
}

.btn-secondary {
    background-color: #6c757d;
    border-color: #6c757d;
}

.current-stats {
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid #e9ecef;
}

.current-stats h5 {
    color: var(--navy-blue);
    margin-bottom: 1rem;
    text-align: center;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
}

.stat-card {
    background: linear-gradient(135deg, var(--navy-blue), #1a2f42);
    color: white;
    border-radius: 10px;
    padding: 1rem;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
}

.stat-icon {
    background: var(--gold);
    color: var(--navy-blue);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
}

.stat-info {
    text-align: center;
}

.stat-info strong {
    display: block;
    font-size: 1.2rem;
    color: var(--gold);
}

.stat-info small {
    color: #e9ecef;
    font-size: 0.8rem;
}

.invalid-feedback {
    color: #dc3545;
    font-size: 0.875rem;
    margin-top: 0.25rem;
}

@media (max-width: 768px) {
    .edit-profile-form-wrapper {
        padding: 1.5rem;
        margin: 0 1rem;
    }
    
    .edit-profile-title {
        font-size: 2rem;
    }
    
    .form-actions {
        flex-direction: column;
    }
    
    .form-actions .btn {
        width: 100%;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}